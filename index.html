<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="color-scheme" content="dark">
    <title>The Burgess Principle</title>
    <meta name="description" content="The Burgess Principle: a citizen-initiated legal doctrine establishing that facially defective warrants under the Rights of Entry (Gas and Electricity Boards) Act 1954 are void ab initio. The principle is free and may be cited by anyone.">
    <meta property="og:title" content="The Burgess Principle">
    <meta property="og:description" content="A citizen-initiated legal doctrine establishing that facially defective warrants under the Rights of Entry (Gas and Electricity Boards) Act 1954 are void ab initio, with downstream remedies for credit contamination and reasonable adjustments for protected characteristics.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://ljbudgie.github.io/Burgessprinciple/">
    <style>
        /* ── Reset & base ── */
        *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

        :root {
            --green-bright: #00ff41;
            --green-mid:    #00cc33;
            --green-dim:    #009922;
            --green-glow:   #00ff41;
            --bg:           #0a0a0a;
            --font-mono:    'Courier New', 'Fira Mono', 'Consolas', monospace;
            --font-size:    15px;
        }

        html, body {
            background-color: var(--bg);
            color: var(--green-mid);
            font-family: var(--font-mono);
            min-height: 100%;
        }

        /* ── Skip link ── */
        .skip-link {
            position: absolute;
            top: -999px;
            left: 0;
            background: var(--bg);
            color: var(--green-bright);
            padding: 8px 16px;
            z-index: 9999;
            text-decoration: none;
            border: 1px solid var(--green-dim);
        }
        .skip-link:focus { top: 0; }

        /* ── Matrix rain canvas ── */
        #matrix-canvas {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            z-index: 0;
            opacity: 0.18;
            pointer-events: none;
        }

        /* ── Scanline overlay ── */
        body::after {
            content: '';
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: repeating-linear-gradient(
                to bottom,
                transparent 0px,
                transparent 3px,
                rgba(0, 0, 0, 0.08) 3px,
                rgba(0, 0, 0, 0.08) 4px
            );
            pointer-events: none;
            z-index: 1;
        }

        /* ── Layout ── */
        .page-wrapper {
            position: relative;
            z-index: 2;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            padding: 0 20px;
        }

        header {
            padding: 60px 20px 30px;
            text-align: center;
        }

        main {
            flex: 1;
            max-width: 680px;
            width: 100%;
            margin: 0 auto;
            padding: 0 0 40px;
        }

        footer {
            text-align: center;
            padding: 30px 20px 40px;
            border-top: 1px solid var(--green-dim);
            font-size: 13px;
            color: var(--green-dim);
            line-height: 1.8;
        }

        /* ── Typography ── */
        h1 {
            font-size: clamp(22px, 5vw, 34px);
            color: var(--green-bright);
            text-shadow:
                0 0 10px var(--green-glow),
                0 0 22px var(--green-glow),
                0 0 40px var(--green-glow);
            letter-spacing: 0.05em;
            margin-bottom: 6px;
        }

        .tagline {
            font-size: 12px;
            color: var(--green-dim);
            letter-spacing: 0.15em;
            text-transform: uppercase;
            margin-bottom: 10px;
        }

        h2 {
            font-size: 13px;
            color: var(--green-bright);
            letter-spacing: 0.12em;
            text-transform: uppercase;
            margin-bottom: 10px;
            text-shadow: 0 0 8px var(--green-glow);
        }

        section {
            border: 1px solid var(--green-dim);
            padding: 20px 24px;
            margin-bottom: 20px;
            background: rgba(0, 255, 65, 0.03);
        }

        p {
            font-size: var(--font-size);
            line-height: 1.75;
            color: var(--green-mid);
        }

        /* ── Links ── */
        a {
            color: var(--green-bright);
            text-decoration: none;
            text-shadow: 0 0 6px var(--green-glow);
        }
        a:hover, a:focus {
            text-decoration: underline;
            text-shadow: 0 0 12px var(--green-glow), 0 0 24px var(--green-glow);
        }

        /* ── Prompt decoration ── */
        .prompt::before {
            content: '> ';
            color: var(--green-bright);
        }

        footer a { color: var(--green-mid); text-shadow: none; }
        footer a:hover { color: var(--green-bright); text-shadow: 0 0 8px var(--green-glow); }

        /* ── Reduced motion ── */
        @media (prefers-reduced-motion: reduce) {
            #matrix-canvas { display: none; }
        }

        /* ── Chat button ── */
        #chat-toggle {
            position: fixed;
            bottom: 24px;
            right: 24px;
            z-index: 100;
            background: var(--bg);
            color: var(--green-bright);
            border: 1px solid var(--green-bright);
            font-family: var(--font-mono);
            font-size: 13px;
            padding: 10px 16px;
            cursor: pointer;
            text-shadow: 0 0 6px var(--green-glow);
            box-shadow: 0 0 10px rgba(0,255,65,0.2);
            letter-spacing: 0.05em;
        }
        #chat-toggle:hover, #chat-toggle:focus {
            box-shadow: 0 0 18px rgba(0,255,65,0.5);
            outline: none;
        }

        /* ── Chat panel ── */
        #chat-panel {
            display: none;
            position: fixed;
            bottom: 72px;
            right: 24px;
            width: 400px;
            max-width: calc(100vw - 48px);
            height: 520px;
            max-height: calc(100vh - 100px);
            z-index: 100;
            border: 1px solid var(--green-dim);
            background: var(--bg);
            flex-direction: column;
            box-shadow: 0 0 24px rgba(0,255,65,0.15);
        }
        #chat-panel.open { display: flex; }

        #chat-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 14px;
            border-bottom: 1px solid var(--green-dim);
            font-size: 12px;
            color: var(--green-bright);
            letter-spacing: 0.1em;
            text-transform: uppercase;
            text-shadow: 0 0 6px var(--green-glow);
        }
        #chat-close {
            background: none;
            border: none;
            color: var(--green-dim);
            font-family: var(--font-mono);
            font-size: 16px;
            cursor: pointer;
            padding: 0 4px;
            line-height: 1;
        }
        #chat-close:hover { color: var(--green-bright); }

        #chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 14px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            font-size: 13px;
            line-height: 1.6;
        }
        #chat-messages::-webkit-scrollbar { width: 4px; }
        #chat-messages::-webkit-scrollbar-track { background: var(--bg); }
        #chat-messages::-webkit-scrollbar-thumb { background: var(--green-dim); }

        .chat-msg {
            max-width: 88%;
            padding: 8px 12px;
            border: 1px solid var(--green-dim);
            white-space: pre-wrap;
            word-break: break-word;
        }
        .chat-msg.user {
            align-self: flex-end;
            color: var(--green-bright);
            border-color: var(--green-bright);
            text-align: right;
        }
        .chat-msg.ai {
            align-self: flex-start;
            color: var(--green-mid);
        }
        .chat-msg.status {
            align-self: center;
            border: none;
            color: var(--green-dim);
            font-size: 12px;
            text-align: center;
            animation: pulse-glow 1.6s ease-in-out infinite;
        }
        @keyframes pulse-glow {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 1; text-shadow: 0 0 8px var(--green-glow); }
        }

        #chat-footer {
            display: flex;
            border-top: 1px solid var(--green-dim);
            padding: 10px 14px;
            gap: 8px;
        }
        #chat-input {
            flex: 1;
            background: transparent;
            border: 1px solid var(--green-dim);
            color: var(--green-bright);
            font-family: var(--font-mono);
            font-size: 13px;
            padding: 6px 10px;
            outline: none;
            caret-color: var(--green-bright);
        }
        #chat-input:focus { border-color: var(--green-bright); }
        #chat-input::placeholder { color: var(--green-dim); }
        #chat-send {
            background: transparent;
            border: 1px solid var(--green-dim);
            color: var(--green-mid);
            font-family: var(--font-mono);
            font-size: 13px;
            padding: 6px 12px;
            cursor: pointer;
            letter-spacing: 0.05em;
        }
        #chat-send:hover:not(:disabled) {
            border-color: var(--green-bright);
            color: var(--green-bright);
        }
        #chat-send:disabled { opacity: 0.4; cursor: not-allowed; }

        /* ── Settings button ── */
        #settings-toggle {
            position: fixed;
            top: 16px;
            right: 16px;
            z-index: 200;
            background: var(--bg);
            color: var(--green-bright);
            border: 1px solid var(--green-bright);
            font-family: var(--font-mono);
            font-size: 18px;
            width: 38px;
            height: 38px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            text-shadow: 0 0 6px var(--green-glow);
            box-shadow: 0 0 10px rgba(0,255,65,0.2);
        }
        #settings-toggle:hover, #settings-toggle:focus {
            box-shadow: 0 0 18px rgba(0,255,65,0.5);
            outline: none;
        }

        /* ── Settings panel ── */
        #settings-panel {
            display: none;
            position: fixed;
            top: 60px;
            right: 16px;
            width: 280px;
            max-width: calc(100vw - 32px);
            z-index: 200;
            border: 1px solid var(--green-dim);
            background: var(--bg);
            box-shadow: 0 0 24px rgba(0,255,65,0.15);
            flex-direction: column;
        }
        #settings-panel.open { display: flex; }

        #settings-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 14px;
            border-bottom: 1px solid var(--green-dim);
            font-size: 12px;
            color: var(--green-bright);
            letter-spacing: 0.1em;
            text-transform: uppercase;
            text-shadow: 0 0 6px var(--green-glow);
        }
        #settings-close {
            background: none;
            border: none;
            color: var(--green-dim);
            font-family: var(--font-mono);
            font-size: 16px;
            cursor: pointer;
            padding: 0 4px;
            line-height: 1;
        }
        #settings-close:hover { color: var(--green-bright); }

        #settings-body {
            padding: 16px 14px;
            display: flex;
            flex-direction: column;
            gap: 14px;
        }

        .setting-row {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }
        .setting-row label {
            font-size: 11px;
            color: var(--green-dim);
            letter-spacing: 0.1em;
            text-transform: uppercase;
        }
        .setting-row input[type="color"] {
            width: 100%;
            height: 32px;
            background: transparent;
            border: 1px solid var(--green-dim);
            cursor: pointer;
            padding: 2px;
        }
        .setting-row select {
            background: var(--bg);
            color: var(--green-bright);
            border: 1px solid var(--green-dim);
            font-family: var(--font-mono);
            font-size: 13px;
            padding: 5px 8px;
            cursor: pointer;
            width: 100%;
        }
        .setting-row select:focus { border-color: var(--green-bright); outline: none; }

        #settings-reset {
            background: transparent;
            border: 1px solid var(--green-dim);
            color: var(--green-dim);
            font-family: var(--font-mono);
            font-size: 12px;
            padding: 7px;
            cursor: pointer;
            letter-spacing: 0.05em;
            margin-top: 4px;
        }
        #settings-reset:hover {
            border-color: var(--green-bright);
            color: var(--green-bright);
        }
    </style>
</head>
<body>
    <a href="#main" class="skip-link">Skip to content</a>

    <canvas id="matrix-canvas" aria-hidden="true"></canvas>

    <!-- Settings button -->
    <button id="settings-toggle" aria-label="Open theme settings" aria-expanded="false" aria-controls="settings-panel">&#9881;</button>

    <!-- Settings panel -->
    <div id="settings-panel" role="dialog" aria-labelledby="settings-title" aria-modal="true">
        <div id="settings-header">
            <span id="settings-title">Theme Settings</span>
            <button id="settings-close" aria-label="Close settings">&times;</button>
        </div>
        <div id="settings-body">
            <div class="setting-row">
                <label for="s-bg">Background Colour</label>
                <input type="color" id="s-bg" value="#0a0a0a">
            </div>
            <div class="setting-row">
                <label for="s-fg">Text Colour</label>
                <input type="color" id="s-fg" value="#00cc33">
            </div>
            <div class="setting-row">
                <label for="s-font">Font</label>
                <select id="s-font">
                    <option value="monospace">Monospace</option>
                    <option value="sans-serif">Sans-serif</option>
                    <option value="serif">Serif</option>
                    <option value="system-ui, sans-serif">System</option>
                </select>
            </div>
            <div class="setting-row">
                <label for="s-size">Font Size</label>
                <select id="s-size">
                    <option value="13px">Small</option>
                    <option value="15px" selected>Medium</option>
                    <option value="17px">Large</option>
                    <option value="20px">Extra Large</option>
                </select>
            </div>
            <button id="settings-reset">&#8635; Reset to Default</button>
        </div>
    </div>

    <div class="page-wrapper">
        <header>
            <h1>The Burgess Principle</h1>
            <p class="tagline">// citizen-initiated legal doctrine //</p>
        </header>

        <main id="main">
            <section aria-labelledby="what-it-is">
                <h2 id="what-it-is">[01] What It Is</h2>
                <p class="prompt">A citizen-initiated legal doctrine establishing that facially defective warrants under the Rights of Entry (Gas and Electricity Boards) Act 1954 are void <em>ab initio</em>, with downstream remedies for credit contamination and reasonable adjustments for protected characteristics.</p>
                <p class="prompt">Credit contamination arising from unlawful action has downstream remedies.</p>
                <p class="prompt">Protected characteristics engage reasonable adjustment obligations throughout.</p>
                <p class="prompt">The principle exists to help every autistic person — and anyone with protected characteristics — who has been failed by facially defective warrants and the systems built on them.</p>
            </section>

            <section aria-labelledby="open-source">
                <h2 id="open-source">[02] Open Source — Free to Cite</h2>
                <p class="prompt">The principle itself is free and may be cited by anyone. Maximum truth reaching maximum people.</p>
                <p class="prompt">All intellectual property — the principle, methodology, and toolkit — is now fully open source, forever. Use it, build on it, share it.</p>
            </section>

            <section aria-labelledby="methodology">
                <h2 id="methodology">[03] Methodology &amp; Toolkit — Open Source</h2>
                <p class="prompt">The methodology and toolkit are fully open source, licensed under the <a href="LICENSE">MIT License</a>. Free for anyone to use, adapt, and build upon.</p>
                <p class="prompt">Integrated with <a href="https://openclaw.im" target="_blank" rel="noopener noreferrer">OpenClaw</a> — the open-source AI automation platform for law — so the full capability of the Burgess Principle is available to everyone, forever.</p>
            </section>

            <section aria-labelledby="status">
                <h2 id="status">[04] Status</h2>
                <p class="prompt">The Burgess Principle has been applied and settled against Eon. It is a proven, applied legal doctrine.</p>
            </section>
        </main>

        <footer>
            &copy; 2026 Lewis Burgess. Content available under the <a href="LICENSE">MIT License</a>.<br>
            Registered trademark application UK00004343685<br><br>
            For media enquiries: <a href="mailto:lewis@burgessprinciple.co.uk">lewis@burgessprinciple.co.uk</a><br>
            For the full sovereign experience — including the AI assistant — use an open-source browser like <a href="https://brave.com">Brave</a> or <a href="https://www.mozilla.org/firefox/">Firefox</a>.
        </footer>
    </div>

    <!-- AI Chatbox -->
    <button id="chat-toggle" aria-expanded="false" aria-controls="chat-panel">Ask about the Burgess Principle</button>

    <div id="chat-panel" role="dialog" aria-labelledby="chat-title" aria-modal="true">
        <div id="chat-header">
            <span id="chat-title">Burgess Principle AI</span>
            <button id="chat-close" aria-label="Close chat">&times;</button>
        </div>
        <div id="chat-messages" aria-live="polite" aria-atomic="false"></div>
        <div id="chat-footer">
            <input id="chat-input" type="text" placeholder="Ask a question..." aria-label="Your question" autocomplete="off" />
            <button id="chat-send" disabled>Send</button>
        </div>
    </div>

    <script>
    (function () {
        var DEFAULTS = {
            bg: '#0a0a0a',
            fg: '#00cc33',
            font: 'monospace',
            size: '15px'
        };

        function applyTheme(t) {
            document.documentElement.style.setProperty('--bg', t.bg);
            document.documentElement.style.setProperty('--green-mid', t.fg);
            document.body.style.backgroundColor = t.bg;
            document.body.style.color = t.fg;
            document.body.style.fontFamily = t.font;
            document.documentElement.style.setProperty('--font-mono', t.font);
            document.documentElement.style.setProperty('--font-size', t.size);
        }

        function loadTheme() {
            try {
                var stored = localStorage.getItem('bp-theme');
                return stored ? JSON.parse(stored) : null;
            } catch (e) { return null; }
        }

        function saveTheme(t) {
            try { localStorage.setItem('bp-theme', JSON.stringify(t)); } catch (e) {}
        }

        function syncControls(t) {
            document.getElementById('s-bg').value = t.bg;
            document.getElementById('s-fg').value = t.fg;
            document.getElementById('s-font').value = t.font;
            document.getElementById('s-size').value = t.size;
        }

        // Apply stored theme immediately
        var current = loadTheme() || Object.assign({}, DEFAULTS);
        applyTheme(current);

        window.addEventListener('DOMContentLoaded', function () {
            syncControls(current);

            var toggle  = document.getElementById('settings-toggle');
            var panel   = document.getElementById('settings-panel');
            var closeBtn = document.getElementById('settings-close');
            var resetBtn = document.getElementById('settings-reset');
            var bgPick  = document.getElementById('s-bg');
            var fgPick  = document.getElementById('s-fg');
            var fontSel = document.getElementById('s-font');
            var sizeSel = document.getElementById('s-size');

            toggle.addEventListener('click', function () {
                var isOpen = panel.classList.toggle('open');
                toggle.setAttribute('aria-expanded', isOpen ? 'true' : 'false');
                if (isOpen) closeBtn.focus();
            });

            closeBtn.addEventListener('click', function () {
                panel.classList.remove('open');
                toggle.setAttribute('aria-expanded', 'false');
                toggle.focus();
            });

            function onChange() {
                current = {
                    bg:   bgPick.value,
                    fg:   fgPick.value,
                    font: fontSel.value,
                    size: sizeSel.value
                };
                applyTheme(current);
                saveTheme(current);
            }

            bgPick.addEventListener('input', onChange);
            fgPick.addEventListener('input', onChange);
            fontSel.addEventListener('change', onChange);
            sizeSel.addEventListener('change', onChange);

            resetBtn.addEventListener('click', function () {
                current = Object.assign({}, DEFAULTS);
                applyTheme(current);
                saveTheme(current);
                syncControls(current);
            });
        });
    }());
    </script>
    <script>
    (function () {
        var canvas = document.getElementById('matrix-canvas');
        if (!canvas) return;

        // Respect reduced motion preference
        if (window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
            canvas.style.display = 'none';
            return;
        }

        var ctx = canvas.getContext('2d');
        var cols, drops;
        var fontSize = 14;

        // Mix of katakana and latin characters
        var chars = 'アイウエオカキクケコサシスセソタチツテトナニヌネノハヒフヘホマミムメモヤユヨラリルレロワヲン0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ@#$%&';

        function resize() {
            canvas.width  = window.innerWidth;
            canvas.height = window.innerHeight;
            cols = Math.floor(canvas.width / fontSize);
            drops = [];
            for (var i = 0; i < cols; i++) {
                drops[i] = Math.random() * -canvas.height / fontSize;
            }
        }

        function draw() {
            ctx.fillStyle = 'rgba(10, 10, 10, 0.05)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            ctx.font = fontSize + 'px ' + "'Courier New', monospace";

            for (var i = 0; i < cols; i++) {
                var char = chars[Math.floor(Math.random() * chars.length)];
                var x = i * fontSize;
                var y = drops[i] * fontSize;

                // Leading character is bright white-green
                ctx.fillStyle = '#afffbc';
                ctx.fillText(char, x, y);

                // Trail characters in mid green
                if (drops[i] > 1) {
                    ctx.fillStyle = '#00cc33';
                    ctx.fillText(chars[Math.floor(Math.random() * chars.length)], x, y - fontSize);
                }

                if (y > canvas.height && Math.random() > 0.975) {
                    drops[i] = 0;
                }
                drops[i] += 0.5;
            }
        }

        resize();
        window.addEventListener('resize', resize);

        var raf;
        function loop() { draw(); raf = requestAnimationFrame(loop); }
        loop();
    }());
    </script>
    <script type="module">
    import * as webllm from 'https://esm.run/@mlc-ai/web-llm';

    var SYSTEM_PROMPT = `You are the Burgess Principle assistant. You only explain the Burgess Principle and its components. The Burgess Principle is a citizen-initiated legal doctrine establishing that facially defective warrants under the Rights of Entry (Gas and Electricity Boards) Act 1954 are void ab initio.

Key components:
- A warrant that is facially defective — meaning it fails on its face to comply with statutory requirements for valid issuance — is void ab initio (it never existed in law).
- Any action taken under a void warrant is itself unlawful from inception.
- Credit contamination arising from unlawful action has downstream remedies.
- Protected characteristics engage reasonable adjustment obligations throughout.
- The principle exists to help every autistic person — and anyone with protected characteristics — who has been failed by facially defective warrants and the systems built on them.

The Burgess Principle has been applied and settled against Eon. It is a proven, applied legal doctrine — not a theory.

The principle is open source and free for anyone to cite. Maximum truth reaching maximum people.

You do not speculate, give personal legal advice, or discuss anything outside the Burgess Principle. If asked something outside your scope, respond: "That falls outside the Burgess Principle."`;

    var MODEL = 'Llama-3.2-1B-Instruct-q4f32_1-MLC';

    var engine = null;
    var ready = false;
    var messages = [{ role: 'system', content: SYSTEM_PROMPT }];

    var toggle  = document.getElementById('chat-toggle');
    var panel   = document.getElementById('chat-panel');
    var closeBtn= document.getElementById('chat-close');
    var msgsDiv = document.getElementById('chat-messages');
    var input   = document.getElementById('chat-input');
    var sendBtn = document.getElementById('chat-send');

    function addMsg(text, type) {
        var el = document.createElement('div');
        el.className = 'chat-msg ' + type;
        el.textContent = text;
        msgsDiv.appendChild(el);
        msgsDiv.scrollTop = msgsDiv.scrollHeight;
        return el;
    }

    function setStatus(text) {
        var existing = msgsDiv.querySelector('.chat-msg.status');
        if (existing) existing.remove();
        if (text) addMsg(text, 'status');
    }

    async function initEngine() {
        if (!navigator.gpu) {
            setStatus("Your browser doesn't support WebGPU. Please try Chrome, Edge, or Brave for AI chat.");
            return;
        }
        setStatus('Loading AI model... (first time only)');
        try {
            engine = await webllm.CreateMLCEngine(MODEL, {
                initProgressCallback: function(p) {
                    if (p.progress < 1) {
                        setStatus('Loading AI model... ' + Math.round(p.progress * 100) + '%');
                    }
                }
            });
            ready = true;
            setStatus(null);
            sendBtn.disabled = false;
            input.focus();
        } catch (err) {
            setStatus('Failed to load model: ' + err.message);
        }
    }

    async function sendMessage() {
        var text = input.value.trim();
        if (!text || !ready) return;
        input.value = '';
        sendBtn.disabled = true;
        addMsg(text, 'user');
        messages.push({ role: 'user', content: text });

        var aiEl = addMsg('', 'ai');
        var fullReply = '';
        try {
            var stream = await engine.chat.completions.create({
                messages: messages,
                stream: true,
                temperature: 0.3,
                max_tokens: 512
            });
            for await (var chunk of stream) {
                var delta = chunk.choices[0].delta.content || '';
                fullReply += delta;
                aiEl.textContent = fullReply;
                msgsDiv.scrollTop = msgsDiv.scrollHeight;
            }
            messages.push({ role: 'assistant', content: fullReply });
        } catch (err) {
            aiEl.textContent = 'Error: ' + err.message;
        }
        sendBtn.disabled = false;
        input.focus();
    }

    toggle.addEventListener('click', function() {
        var isOpen = panel.classList.toggle('open');
        toggle.setAttribute('aria-expanded', isOpen ? 'true' : 'false');
        if (isOpen && !engine && !ready) {
            initEngine();
        }
        if (isOpen) input.focus();
    });

    closeBtn.addEventListener('click', function() {
        panel.classList.remove('open');
        toggle.setAttribute('aria-expanded', 'false');
        toggle.focus();
    });

    sendBtn.addEventListener('click', sendMessage);
    input.addEventListener('keydown', function(e) {
        if (e.key === 'Enter' && !e.shiftKey) { e.preventDefault(); sendMessage(); }
    });
    </script>
</body>
</html>
