name: Grid Guard

on:
  push:
    branches:
      - main

jobs:
  check:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v2

      - name: Calculate SHA-256 hash of SOUL.md
        id: calculate_hash
        run: |
          HASH=$(sha256sum SOUL.md | awk '{ print $1 }')
          echo "SOVEREIGNTY_TOKEN=$HASH" >> $GITHUB_ENV

      - name: Validate SOVEREIGNTY_TOKEN
        run: |
          if [ "$SOVEREIGNTY_TOKEN" != "$EXPECTED_HASH" ]; then
            echo "Error: The calculated hash does not match the expected hash!";
            exit 1;
          fi
        env:
          EXPECTED_HASH: ${{ secrets.EXPECTED_HASH }}
